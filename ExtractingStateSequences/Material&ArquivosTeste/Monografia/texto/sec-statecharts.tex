%% ------------------------------------------------------------------------- %%
\section{Statecharts}
\label{sec:statecharts}

A software specification is a reference document which contains the requisites the program should satisfy. It can also be understood as a model of how the system should behave. A specification may be developed with natural language, with user cases for example, or usisng formal software engeering techniques.

Statechats are a type of formal software specification based on finite states machines (FSM) specially used in complex systems modeling, such as reactive systems and were defined in \cite{harel87:semantics_statecharts}. Similar to an automaton, a statechart has sets of states, transitions and input events that cause change of state. However, a statechart has additional features: orthogonality, hierarchy, broadcasting and history.

\subsection{Nondeterministic finite automata}

\textbf{Definition:} A nondeterministic finite automaton is a quintuple $M = (K,\Sigma,\Delta,s,F)$, where:

\begin{itemize}

\item $K$ is the set of states

\item $\Sigma$ is the input alphabet

\item $\Delta$ is the transition relation, a subset of $K\times(\Sigma\cup{e})\times K$, where $e$ is the empty string

\item $s \in K$ is the initial state

\item $F \subseteq K$ is the set of final states
\end{itemize}

Each tripe $(q,a,p) \in \Delta$ is a transition of $M$. If $M$ is currently in state $q$ and the next input is $a$, then $M$ may follow any transition of the form $(q,a,p)$ or $(q,e,p)$. In the later case, no input is read. A configuration of $M$ is an element of $K\time \Sigma^*$ and the relation $\vdash$ (yields one step) between two configuarions is defined as: $(q,w) \vdash (q',w') \Leftrightarrow$ there is a $u \in \Sigma \cup {e}$ such that $w = uw'$ and $(q,u,q') \in \Delta$.

Further information and formalism regarding finite automata can be obtained in \cite{Lewis:98}. 

\subsection{A nondeterministic automaton example}

\subsection{Statechart models}

\subsection{Orthogonality}

\subsection{Hierarchy}

\subsection{Broadcasting}

\subsection{History}

\subsection{A statechart example}

\iffalse
\begin{itemize}
\item Ortogonalidade

Um statechart pode estar em mais de um estado simultaneamente, o que é útil para modelar situações de concorrência e paralelismo. O conjunto de estados ativos em determinado instante é denominado de configuração. Na figura~\ref{fig:fig1}, os estados $F$ e $G$ são ortogonais. Assim, se o statechart se encontrar no estado $A$ e o evento $a$ ocorrer, a configuração do statechart irá mudar para os estados $F$ e $G$ simultaneamente.
\item Hierarquia

Um estado pode conter sub-estados e transições internas, elevando a capacidade de abstração e encapsulamento. Na figura~\ref{fig:fig1}, Os estados $F$ e $G$ são sub-estados do estado $I$. Já os estados $B$ e $C$ são sub-estados do estado $F$.
\item Condições de guarda

É possível condicionar a ocorrência de uma transição ao valor de uma variável, à entrada de um estado ou à ocorrência de uma ação. Na figura~\ref{fig:fig1}, a transição do estado $D$ para o estado $E$ possui uma condição de guarda: $in(C)$, que é verdadeira quando o statechart se encontra no estado $C$ e falsa caso contrário. Então, a mudança de $D$ para $E$ acontecerá de fato se o evento $e$ ocorrer e a condição $in(C)$ for verdadeira, ou seja, quando $e$ ocorrer e a configuração atual do statechart contiver o estado $C$. 

\item Broadcasting

Uma transição possui um evento de entrada, necessário para que a transição aconteça, mas também pode ter uma ação de saída, que será disparada ao final da mudança de estado. Esse artefato permite que reações em cadeia ocorram em um statechart. Na figura~\ref{fig:fig1}, a transição do estado $E$ para $D$ possui um evento de entrada $c$ e uma ação de saída $d$. Assim, suponha que os estados $C$ e $E$ constituam a atual configuração do statechart e o evento $c$ ocorra. A transição $E$ para $D$ ocorrerá e desencadeará a ação $d$, que por sua vez acarretará a transição de $C$ para $B$. No final, statechart estará com sua configuração nos estados $D$ e $B$, ainda que somente o evento $c$ tenha ocorrido. 
\item História

Um statechart é capaz de lembrar estados já visitados anteriormente. Na figura~\ref{fig:fig2}, o armazenamento da história do statechart é representado pelo pseudo-estado $H$. Se a configuração atual é $D$ e o evento $a$ ocorre, a próxima configuração será constituída pelo sub-estado de $A$ mais recentemente visitado: $B$ ou $C$. 
\end{itemize}

Um statechart também possui um estado inicial e pode possuir um estado final. Em casos de sistemas reativos, é comum que o estado final esteja ausente. O estado inicial é representado por um círculo completamente preenchido e o estado final, por um círculo preenchido contido em uma circunferência.

Um exemplo de figura está na figura~\ref{fig:fig1}.
\begin{figure}[htb]
\includegraphics[width=10cm]{figuras/fig1}
\caption{\label{fig:fig1}Exemplo de statechart}
\end{figure}

\begin{figure}[htb]
\includegraphics[width=12cm]{figuras/fig2}
\caption{\label{fig:fig2}Exemplo de statechart}
\end{figure}
\fi
